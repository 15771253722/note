
--<!-- SHEET1Õ≥º∆  ° -->
select * from HX_DM_ZDY.DM_GY_SWJG T WHERE T.SWJG_DM = '00000000000'
select * from DL_DQRB;

-- ‘¬æ˘”√µÁπÊƒ££¨1 «0µÁ¡ø£¨2 «0-1000,3 «1000-5000£¨4 «5000-1ÕÚ£¨5 «1ÕÚ“‘…œ

-- <!-- SHEET1Õ≥º∆  ° -->
WITH AA AS (SELECT A.ZGSWJ_DM, COUNT(1) YPPQC FROM DL_QRB A WHERE A.ZGSWJ_DM IS NOT NULL GROUP BY A.ZGSWJ_DM) ,
     BB AS (SELECT B.ZGSWJ_DM, COUNT(1) YSZL FROM DL_DQRB B WHERE B.ZGSWJ_DM IS NOT NULL AND B.SJLY LIKE '%¥Ê“…%' GROUP BY B.ZGSWJ_DM),
     CC AS (SELECT C.ZGSWJ_DM, COUNT(1) YSYWC FROM DL_DQRB C WHERE C.ZGSWJ_DM IS NOT NULL AND C.SJLY LIKE '%¥Ê“…%' AND C.YXBZ = 'N' GROUP BY C.ZGSWJ_DM),
     DD AS (SELECT D.ZGSWJ_DM, COUNT(1) WDWPPZL FROM DL_DQRB D WHERE D.ZGSWJ_DM IS NOT NULL AND D.SJLY LIKE '%Œ¥∆•≈‰%' AND D.YJYDGM = '5' GROUP BY D.ZGSWJ_DM),
     EE AS (SELECT E.ZGSWJ_DM, COUNT(1) WDWPPYWC FROM DL_DQRB E WHERE E.ZGSWJ_DM IS NOT NULL AND E.SJLY LIKE '%Œ¥∆•≈‰%' AND E.YXBZ = 'N' AND E.YJYDGM = '5' GROUP BY E.ZGSWJ_DM),
     FF AS (SELECT F.ZGSWJ_DM, COUNT(1) SDWPPZL FROM DL_DQRB F WHERE F.ZGSWJ_DM IS NOT NULL AND F.SJLY LIKE '%Œ¥∆•≈‰%' AND F.YJYDGM = '4' GROUP BY F.ZGSWJ_DM),
     GG AS (SELECT G.ZGSWJ_DM, COUNT(1) SDWPPYWC FROM DL_DQRB G WHERE G.ZGSWJ_DM IS NOT NULL AND G.SJLY LIKE '%Œ¥∆•≈‰%' AND G.YXBZ = 'N' AND G.YJYDGM = '4' GROUP BY G.ZGSWJ_DM),
     HH AS (SELECT H.ZGSWJ_DM, COUNT(1) YESDWPPZL FROM DL_DQRB H WHERE H.ZGSWJ_DM IS NOT NULL AND H.SJLY LIKE '%Œ¥∆•≈‰%' AND H.YJYDGM IN ('1','2','3') GROUP BY H.ZGSWJ_DM),
     II AS (SELECT I.ZGSWJ_DM, COUNT(1) YESDWPPYWC FROM DL_DQRB I WHERE I.ZGSWJ_DM IS NOT NULL AND I.SJLY LIKE '%Œ¥∆•≈‰%' AND I.YXBZ = 'N' AND I.YJYDGM IN ('1','2','3') GROUP BY I.ZGSWJ_DM)

 SELECT (SELECT K.SWJG_DM FROM HX_DM_ZDY.DM_GY_SWJG K WHERE K.SWJG_DM IN (SELECT M.SJSWJG_DM FROM HX_DM_ZDY.DM_GY_SWJG M WHERE M.SWJG_DM = JG.SJSWJG_DM)) AS ZGSWJGDM,
        (SELECT P.SWJGMC FROM HX_DM_ZDY.DM_GY_SWJG P WHERE P.SWJG_DM IN (SELECT T.SJSWJG_DM FROM HX_DM_ZDY.DM_GY_SWJG T WHERE T.SWJG_DM = JG.SJSWJG_DM)) AS ZGSWJGMC,
        (SELECT SWJG.SWJGMC FROM HX_DM_ZDY.DM_GY_SWJG SWJG WHERE SWJG.SWJG_DM = JG.SJSWJG_DM) AS XXSWJGMC,
        SUM(JJ.YPPQC) AS YPPQC,
        SUM(JJ.YSZL) AS YSZL,
        SUM(JJ.YSYWC) AS YSYWC,
        (SUM(JJ.YSZL) - SUM(JJ.YSYWC)) AS YSSY,
        (CASE WHEN SUM(JJ.YSZL) = 0 THEN '0%' ELSE (TRUNC(SUM(JJ.YSYWC) / SUM(JJ.YSZL) * 100 , 2)) || '%' END) AS YSWCL,
        SUM(JJ.WDWPPZL) AS WDWPPZL,
        SUM(JJ.WDWPPYWC) AS WDWPPYWC,
        (SUM(JJ.WDWPPZL) - SUM(JJ.WDWPPYWC)) AS WDWPPSY,
        (CASE WHEN SUM(JJ.WDWPPZL) = 0 THEN '0%' ELSE (TRUNC(SUM(JJ.WDWPPYWC) / SUM(JJ.WDWPPZL) * 100 , 2)) || '%' END) AS WDWCL,
        SUM(JJ.SDWPPZL) AS SDWPPZL,
        SUM(JJ.SDWPPYWC) AS SDWPPYWC,
        (SUM(JJ.SDWPPZL) - SUM(JJ.SDWPPYWC)) AS SDWPPSY,
        (CASE WHEN SUM(JJ.SDWPPZL) = 0 THEN '0%' ELSE (TRUNC(SUM(JJ.SDWPPYWC) / SUM(JJ.SDWPPZL) * 100 , 2)) || '%' END) AS SDWCL,
        SUM(JJ.YESDWPPZL) AS YESDWPPZL,
        SUM(JJ.YESDWPPYWC) AS YESDWPPYWC,
        (SUM(JJ.YESDWPPZL) - SUM(JJ.YESDWPPYWC)) AS YESDWPPSY,
        (CASE WHEN SUM(JJ.YESDWPPZL) = 0 THEN '0%' ELSE (TRUNC(SUM(JJ.YESDWPPYWC) / SUM(JJ.YESDWPPZL) * 100 , 2)) || '%' END) AS YESDWCL,
        (CASE WHEN (SUM(JJ.YSZL)+SUM(JJ.WDWPPZL)+SUM(JJ.SDWPPZL)+SUM(JJ.YESDWPPZL)) = 0 THEN '0%' ELSE (TRUNC((SUM(JJ.YSYWC)+SUM(JJ.WDWPPYWC)+SUM(JJ.SDWPPYWC)+SUM(JJ.YESDWPPYWC)) / (SUM(JJ.YSZL)+SUM(JJ.WDWPPZL)+SUM(JJ.SDWPPZL)+SUM(JJ.YESDWPPZL)) * 100 , 2)) || '%' END) WCL
  FROM (
    SELECT COALESCE(AA.ZGSWJ_DM, BB.ZGSWJ_DM, CC.ZGSWJ_DM, DD.ZGSWJ_DM, EE.ZGSWJ_DM , FF.ZGSWJ_DM , GG.ZGSWJ_DM, HH.ZGSWJ_DM, II.ZGSWJ_DM) ZGSWJ_DM,
           (CASE WHEN AA.YPPQC IS NULL THEN 0 ELSE AA.YPPQC END ) YPPQC,
           (CASE WHEN BB.YSZL IS NULL THEN 0 ELSE BB.YSZL END ) YSZL,
           (CASE WHEN CC.YSYWC IS NULL THEN 0 ELSE CC.YSYWC END ) YSYWC,
           (CASE WHEN DD.WDWPPZL IS NULL THEN 0 ELSE DD.WDWPPZL END ) WDWPPZL,
           (CASE WHEN EE.WDWPPYWC IS NULL THEN 0 ELSE EE.WDWPPYWC END ) WDWPPYWC,
           (CASE WHEN FF.SDWPPZL IS NULL THEN 0 ELSE FF.SDWPPZL END ) SDWPPZL,
           (CASE WHEN GG.SDWPPYWC IS NULL THEN 0 ELSE GG.SDWPPYWC END ) SDWPPYWC,
           (CASE WHEN HH.YESDWPPZL IS NULL THEN 0 ELSE HH.YESDWPPZL END ) YESDWPPZL,
           (CASE WHEN II.YESDWPPYWC IS NULL THEN 0 ELSE II.YESDWPPYWC END ) YESDWPPYWC
      FROM AA FULL JOIN BB ON AA.ZGSWJ_DM = BB.ZGSWJ_DM
              FULL JOIN CC ON AA.ZGSWJ_DM = CC.ZGSWJ_DM
              FULL JOIN DD ON AA.ZGSWJ_DM = DD.ZGSWJ_DM
              FULL JOIN EE ON AA.ZGSWJ_DM = EE.ZGSWJ_DM
              FULL JOIN FF ON AA.ZGSWJ_DM = FF.ZGSWJ_DM
              FULL JOIN GG ON AA.ZGSWJ_DM = GG.ZGSWJ_DM
              FULL JOIN HH ON AA.ZGSWJ_DM = HH.ZGSWJ_DM
              FULL JOIN II ON AA.ZGSWJ_DM = II.ZGSWJ_DM) JJ , HX_DM_ZDY.DM_GY_SWJG JG
        WHERE JJ.ZGSWJ_DM = JG.SWJG_DM
          AND JJ.ZGSWJ_DM IN (SELECT JG.SWJG_DM FROM DM_GY_SWJG JG WHERE JG.YXBZ = 'Y' AND JG.XYBZ = 'Y' START WITH JG.SWJG_DM = '13300000000' CONNECT BY PRIOR JG.SWJG_DM = JG.SJSWJG_DM)
     GROUP BY JG.SJSWJG_DM
     ORDER BY JG.SJSWJG_DM ASC;    
    
    
    
-- <!-- SHEET1◊‹º∆  ° -->
 
WITH AA AS (SELECT A.ZGSWJ_DM, COUNT(1) YPPQC FROM DL_QRB A WHERE A.ZGSWJ_DM IS NOT NULL GROUP BY A.ZGSWJ_DM) ,
     BB AS (SELECT B.ZGSWJ_DM, COUNT(1) YSZL FROM DL_DQRB B WHERE B.ZGSWJ_DM IS NOT NULL AND B.SJLY LIKE '%¥Ê“…%' GROUP BY B.ZGSWJ_DM),
     CC AS (SELECT C.ZGSWJ_DM, COUNT(1) YSYWC FROM DL_DQRB C WHERE C.ZGSWJ_DM IS NOT NULL AND C.SJLY LIKE '%¥Ê“…%' AND C.YXBZ = 'N' GROUP BY C.ZGSWJ_DM),
     DD AS (SELECT D.ZGSWJ_DM, COUNT(1) WDWPPZL FROM DL_DQRB D WHERE D.ZGSWJ_DM IS NOT NULL AND D.SJLY LIKE '%Œ¥∆•≈‰%' AND D.YJYDGM = '5' GROUP BY D.ZGSWJ_DM),
     EE AS (SELECT E.ZGSWJ_DM, COUNT(1) WDWPPYWC FROM DL_DQRB E WHERE E.ZGSWJ_DM IS NOT NULL AND E.SJLY LIKE '%Œ¥∆•≈‰%' AND E.YXBZ = 'N' AND E.YJYDGM = '5' GROUP BY E.ZGSWJ_DM),
     FF AS (SELECT F.ZGSWJ_DM, COUNT(1) SDWPPZL FROM DL_DQRB F WHERE F.ZGSWJ_DM IS NOT NULL AND F.SJLY LIKE '%Œ¥∆•≈‰%' AND F.YJYDGM = '4' GROUP BY F.ZGSWJ_DM),
     GG AS (SELECT G.ZGSWJ_DM, COUNT(1) SDWPPYWC FROM DL_DQRB G WHERE G.ZGSWJ_DM IS NOT NULL AND G.SJLY LIKE '%Œ¥∆•≈‰%' AND G.YXBZ = 'N' AND G.YJYDGM = '4' GROUP BY G.ZGSWJ_DM),
     HH AS (SELECT H.ZGSWJ_DM, COUNT(1) YESDWPPZL FROM DL_DQRB H WHERE H.ZGSWJ_DM IS NOT NULL AND H.SJLY LIKE '%Œ¥∆•≈‰%' AND H.YJYDGM IN ('1','2','3') GROUP BY H.ZGSWJ_DM),
     II AS (SELECT I.ZGSWJ_DM, COUNT(1) YESDWPPYWC FROM DL_DQRB I WHERE I.ZGSWJ_DM IS NOT NULL AND I.SJLY LIKE '%Œ¥∆•≈‰%' AND I.YXBZ = 'N' AND I.YJYDGM IN ('1','2','3') GROUP BY I.ZGSWJ_DM)


SELECT SUM(KK.YPPQC) AS YPPQC,
       SUM(KK.YSZL) AS YSZL,
       SUM(KK.YSYWC) AS YSYWC,
       SUM(KK.YSSY) AS YSSY,
       (CASE WHEN SUM(KK.YSZL) = 0 THEN '0%' ELSE (TRUNC(SUM(KK.YSYWC) / SUM(KK.YSZL) * 100 , 2)) || '%' END) AS YSWCL,
       SUM(KK.WDWPPZL) AS WDWPPZL,
       SUM(KK.WDWPPYWC) AS WDWPPYWC,
       SUM(KK.WDWPPSY) AS WDWPPSY,
       (CASE WHEN SUM(KK.WDWPPZL) = 0 THEN '0%' ELSE (TRUNC(SUM(KK.WDWPPYWC) / SUM(KK.WDWPPZL) * 100 , 2)) || '%' END) AS WDWCL,
       SUM(KK.SDWPPZL) AS SDWPPZL,
       SUM(KK.SDWPPYWC) AS SDWPPYWC,
       SUM(KK.SDWPPSY) AS SDWPPSY,
       (CASE WHEN SUM(KK.SDWPPZL) = 0 THEN '0%' ELSE (TRUNC(SUM(KK.SDWPPYWC) / SUM(KK.SDWPPZL) * 100 , 2)) || '%' END) AS SDWCL,
       SUM(KK.YESDWPPZL) AS YESDWPPZL,
       SUM(KK.YESDWPPYWC) AS YESDWPPYWC,
       SUM(KK.YESDWPPSY) AS YESDWPPSY,
       (CASE WHEN SUM(KK.YESDWPPZL) = 0 THEN '0%' ELSE (TRUNC(SUM(KK.YESDWPPYWC) / SUM(KK.YESDWPPZL) * 100 , 2)) || '%' END) AS YESDWCL,
       (CASE WHEN (SUM(KK.YSZL)+SUM(KK.WDWPPZL)+SUM(KK.SDWPPZL)+SUM(KK.YESDWPPZL)) = 0 THEN '0%' ELSE (TRUNC((SUM(KK.YSYWC)+SUM(KK.WDWPPYWC)+SUM(KK.SDWPPYWC)+SUM(KK.YESDWPPYWC)) / (SUM(KK.YSZL)+SUM(KK.WDWPPZL)+SUM(KK.SDWPPZL)+SUM(KK.YESDWPPZL)) * 100 , 2)) || '%' END) WCL
 FROM£®
 SELECT '1' XH,
        (SELECT K.SWJG_DM FROM HX_DM_ZDY.DM_GY_SWJG K WHERE K.SWJG_DM IN (SELECT M.SJSWJG_DM FROM HX_DM_ZDY.DM_GY_SWJG M WHERE M.SWJG_DM = JG.SJSWJG_DM)) AS ZGSWJGDM,
        (SELECT P.SWJGMC FROM HX_DM_ZDY.DM_GY_SWJG P WHERE P.SWJG_DM IN (SELECT T.SJSWJG_DM FROM HX_DM_ZDY.DM_GY_SWJG T WHERE T.SWJG_DM = JG.SJSWJG_DM)) AS ZGSWJGMC,
        (SELECT SWJG.SWJGMC FROM HX_DM_ZDY.DM_GY_SWJG SWJG WHERE SWJG.SWJG_DM = JG.SJSWJG_DM) AS XXSWJGMC,
        SUM(JJ.YPPQC) AS YPPQC,
        SUM(JJ.YSZL) AS YSZL,
        SUM(JJ.YSYWC) AS YSYWC,
        (SUM(JJ.YSZL) - SUM(JJ.YSYWC)) AS YSSY,
        (CASE WHEN SUM(JJ.YSZL) = 0 THEN '0%' ELSE (TRUNC(SUM(JJ.YSYWC) / SUM(JJ.YSZL) * 100 , 2)) || '%' END) AS YSWCL,
        SUM(JJ.WDWPPZL) AS WDWPPZL,
        SUM(JJ.WDWPPYWC) AS WDWPPYWC,
        (SUM(JJ.WDWPPZL) - SUM(JJ.WDWPPYWC)) AS WDWPPSY,
        (CASE WHEN SUM(JJ.WDWPPZL) = 0 THEN '0%' ELSE (TRUNC(SUM(JJ.WDWPPYWC) / SUM(JJ.WDWPPZL) * 100 , 2)) || '%' END) AS WDWCL,
        SUM(JJ.SDWPPZL) AS SDWPPZL,
        SUM(JJ.SDWPPYWC) AS SDWPPYWC,
        (SUM(JJ.SDWPPZL) - SUM(JJ.SDWPPYWC)) AS SDWPPSY,
        (CASE WHEN SUM(JJ.SDWPPZL) = 0 THEN '0%' ELSE (TRUNC(SUM(JJ.SDWPPYWC) / SUM(JJ.SDWPPZL) * 100 , 2)) || '%' END) AS SDWCL,
        SUM(JJ.YESDWPPZL) AS YESDWPPZL,
        SUM(JJ.YESDWPPYWC) AS YESDWPPYWC,
        (SUM(JJ.YESDWPPZL) - SUM(JJ.YESDWPPYWC)) AS YESDWPPSY,
        (CASE WHEN SUM(JJ.YESDWPPZL) = 0 THEN '0%' ELSE (TRUNC(SUM(JJ.YESDWPPYWC) / SUM(JJ.YESDWPPZL) * 100 , 2)) || '%' END) AS YESDWCL,
        (CASE WHEN (SUM(JJ.YSZL)+SUM(JJ.WDWPPZL)+SUM(JJ.SDWPPZL)+SUM(JJ.YESDWPPZL)) = 0 THEN '0%' ELSE (TRUNC((SUM(JJ.YSYWC)+SUM(JJ.WDWPPYWC)+SUM(JJ.SDWPPYWC)+SUM(JJ.YESDWPPYWC)) / (SUM(JJ.YSZL)+SUM(JJ.WDWPPZL)+SUM(JJ.SDWPPZL)+SUM(JJ.YESDWPPZL)) * 100 , 2)) || '%' END) WCL
  FROM (
    SELECT COALESCE(AA.ZGSWJ_DM, BB.ZGSWJ_DM, CC.ZGSWJ_DM, DD.ZGSWJ_DM, EE.ZGSWJ_DM , FF.ZGSWJ_DM , GG.ZGSWJ_DM, HH.ZGSWJ_DM, II.ZGSWJ_DM) ZGSWJ_DM,
           (CASE WHEN AA.YPPQC IS NULL THEN 0 ELSE AA.YPPQC END ) YPPQC,
           (CASE WHEN BB.YSZL IS NULL THEN 0 ELSE BB.YSZL END ) YSZL,
           (CASE WHEN CC.YSYWC IS NULL THEN 0 ELSE CC.YSYWC END ) YSYWC,
           (CASE WHEN DD.WDWPPZL IS NULL THEN 0 ELSE DD.WDWPPZL END ) WDWPPZL,
           (CASE WHEN EE.WDWPPYWC IS NULL THEN 0 ELSE EE.WDWPPYWC END ) WDWPPYWC,
           (CASE WHEN FF.SDWPPZL IS NULL THEN 0 ELSE FF.SDWPPZL END ) SDWPPZL,
           (CASE WHEN GG.SDWPPYWC IS NULL THEN 0 ELSE GG.SDWPPYWC END ) SDWPPYWC,
           (CASE WHEN HH.YESDWPPZL IS NULL THEN 0 ELSE HH.YESDWPPZL END ) YESDWPPZL,
           (CASE WHEN II.YESDWPPYWC IS NULL THEN 0 ELSE II.YESDWPPYWC END ) YESDWPPYWC
      FROM AA FULL JOIN BB ON AA.ZGSWJ_DM = BB.ZGSWJ_DM
              FULL JOIN CC ON AA.ZGSWJ_DM = CC.ZGSWJ_DM
              FULL JOIN DD ON AA.ZGSWJ_DM = DD.ZGSWJ_DM
              FULL JOIN EE ON AA.ZGSWJ_DM = EE.ZGSWJ_DM
              FULL JOIN FF ON AA.ZGSWJ_DM = FF.ZGSWJ_DM
              FULL JOIN GG ON AA.ZGSWJ_DM = GG.ZGSWJ_DM
              FULL JOIN HH ON AA.ZGSWJ_DM = HH.ZGSWJ_DM
              FULL JOIN II ON AA.ZGSWJ_DM = II.ZGSWJ_DM) JJ , HX_DM_ZDY.DM_GY_SWJG JG
        WHERE JJ.ZGSWJ_DM = JG.SWJG_DM
          AND JJ.ZGSWJ_DM IN (SELECT JG.SWJG_DM FROM DM_GY_SWJG JG WHERE JG.YXBZ = 'Y' AND JG.XYBZ = 'Y' START WITH JG.SWJG_DM = '13300000000' CONNECT BY PRIOR JG.SWJG_DM = JG.SJSWJG_DM)
     GROUP BY JG.SJSWJG_DM) KK GROUP BY KK.XH;

------------------------------------------------------------------------------------------------------------------------------------------------------------------------   
     
-- <!-- SHEET1Õ≥º∆  – -->
WITH AA AS (SELECT A.ZGSWJ_DM, COUNT(1) YPPQC FROM DL_QRB A WHERE A.ZGSWJ_DM IS NOT NULL GROUP BY A.ZGSWJ_DM) ,
     BB AS (SELECT B.ZGSWJ_DM, COUNT(1) YSZL FROM DL_DQRB B WHERE B.ZGSWJ_DM IS NOT NULL AND B.SJLY LIKE '%¥Ê“…%' GROUP BY B.ZGSWJ_DM),
     CC AS (SELECT C.ZGSWJ_DM, COUNT(1) YSYWC FROM DL_DQRB C WHERE C.ZGSWJ_DM IS NOT NULL AND C.SJLY LIKE '%¥Ê“…%' AND C.YXBZ = 'N' GROUP BY C.ZGSWJ_DM),
     DD AS (SELECT D.ZGSWJ_DM, COUNT(1) WDWPPZL FROM DL_DQRB D WHERE D.ZGSWJ_DM IS NOT NULL AND D.SJLY LIKE '%Œ¥∆•≈‰%' AND D.YJYDGM = '5' GROUP BY D.ZGSWJ_DM),
     EE AS (SELECT E.ZGSWJ_DM, COUNT(1) WDWPPYWC FROM DL_DQRB E WHERE E.ZGSWJ_DM IS NOT NULL AND E.SJLY LIKE '%Œ¥∆•≈‰%' AND E.YXBZ = 'N' AND E.YJYDGM = '5' GROUP BY E.ZGSWJ_DM),
     FF AS (SELECT F.ZGSWJ_DM, COUNT(1) SDWPPZL FROM DL_DQRB F WHERE F.ZGSWJ_DM IS NOT NULL AND F.SJLY LIKE '%Œ¥∆•≈‰%' AND F.YJYDGM = '4' GROUP BY F.ZGSWJ_DM),
     GG AS (SELECT G.ZGSWJ_DM, COUNT(1) SDWPPYWC FROM DL_DQRB G WHERE G.ZGSWJ_DM IS NOT NULL AND G.SJLY LIKE '%Œ¥∆•≈‰%' AND G.YXBZ = 'N' AND G.YJYDGM = '4' GROUP BY G.ZGSWJ_DM),
     HH AS (SELECT H.ZGSWJ_DM, COUNT(1) YESDWPPZL FROM DL_DQRB H WHERE H.ZGSWJ_DM IS NOT NULL AND H.SJLY LIKE '%Œ¥∆•≈‰%' AND H.YJYDGM IN ('1','2','3') GROUP BY H.ZGSWJ_DM),
     II AS (SELECT I.ZGSWJ_DM, COUNT(1) YESDWPPYWC FROM DL_DQRB I WHERE I.ZGSWJ_DM IS NOT NULL AND I.SJLY LIKE '%Œ¥∆•≈‰%' AND I.YXBZ = 'N' AND I.YJYDGM IN ('1','2','3') GROUP BY I.ZGSWJ_DM)

 SELECT (SELECT K.SWJG_DM FROM HX_DM_ZDY.DM_GY_SWJG K WHERE K.SWJG_DM IN (SELECT M.SJSWJG_DM FROM HX_DM_ZDY.DM_GY_SWJG M WHERE M.SWJG_DM = JJ.ZGSWJ_DM)) AS ZGSWJGDM,
        (SELECT P.SWJGMC FROM HX_DM_ZDY.DM_GY_SWJG P WHERE P.SWJG_DM IN (SELECT T.SJSWJG_DM FROM HX_DM_ZDY.DM_GY_SWJG T WHERE T.SWJG_DM = JJ.ZGSWJ_DM)) AS ZGSWJGMC,
        (SELECT SWJG.SWJGMC FROM HX_DM_ZDY.DM_GY_SWJG SWJG WHERE SWJG.SWJG_DM = JJ.ZGSWJ_DM) AS XXSWJGMC,
        SUM(JJ.YPPQC) AS YPPQC,
        SUM(JJ.YSZL) AS YSZL,
        SUM(JJ.YSYWC) AS YSYWC,
        (SUM(JJ.YSZL) - SUM(JJ.YSYWC)) AS YSSY,
        (CASE WHEN SUM(JJ.YSZL) = 0 THEN '0%' ELSE (TRUNC(SUM(JJ.YSYWC) / SUM(JJ.YSZL) * 100 , 2)) || '%' END) AS YSWCL,
        SUM(JJ.WDWPPZL) AS WDWPPZL,
        SUM(JJ.WDWPPYWC) AS WDWPPYWC,
        (SUM(JJ.WDWPPZL) - SUM(JJ.WDWPPYWC)) AS WDWPPSY,
        (CASE WHEN SUM(JJ.WDWPPZL) = 0 THEN '0%' ELSE (TRUNC(SUM(JJ.WDWPPYWC) / SUM(JJ.WDWPPZL) * 100 , 2)) || '%' END) AS WDWCL,
        SUM(JJ.SDWPPZL) AS SDWPPZL,
        SUM(JJ.SDWPPYWC) AS SDWPPYWC,
        (SUM(JJ.SDWPPZL) - SUM(JJ.SDWPPYWC)) AS SDWPPSY,
        (CASE WHEN SUM(JJ.SDWPPZL) = 0 THEN '0%' ELSE (TRUNC(SUM(JJ.SDWPPYWC) / SUM(JJ.SDWPPZL) * 100 , 2)) || '%' END) AS SDWCL,
        SUM(JJ.YESDWPPZL) AS YESDWPPZL,
        SUM(JJ.YESDWPPYWC) AS YESDWPPYWC,
        (SUM(JJ.YESDWPPZL) - SUM(JJ.YESDWPPYWC)) AS YESDWPPSY,
        (CASE WHEN SUM(JJ.YESDWPPZL) = 0 THEN '0%' ELSE (TRUNC(SUM(JJ.YESDWPPYWC) / SUM(JJ.YESDWPPZL) * 100 , 2)) || '%' END) AS YESDWCL,
        (CASE WHEN (SUM(JJ.YSZL)+SUM(JJ.WDWPPZL)+SUM(JJ.SDWPPZL)+SUM(JJ.YESDWPPZL)) = 0 THEN '0%' ELSE (TRUNC((SUM(JJ.YSYWC)+SUM(JJ.WDWPPYWC)+SUM(JJ.SDWPPYWC)+SUM(JJ.YESDWPPYWC)) / (SUM(JJ.YSZL)+SUM(JJ.WDWPPZL)+SUM(JJ.SDWPPZL)+SUM(JJ.YESDWPPZL)) * 100 , 2)) || '%' END) WCL
  FROM (
    SELECT COALESCE(AA.ZGSWJ_DM, BB.ZGSWJ_DM, CC.ZGSWJ_DM, DD.ZGSWJ_DM, EE.ZGSWJ_DM , FF.ZGSWJ_DM , GG.ZGSWJ_DM, HH.ZGSWJ_DM, II.ZGSWJ_DM) ZGSWJ_DM,
           (CASE WHEN AA.YPPQC IS NULL THEN 0 ELSE AA.YPPQC END ) YPPQC,
           (CASE WHEN BB.YSZL IS NULL THEN 0 ELSE BB.YSZL END ) YSZL,
           (CASE WHEN CC.YSYWC IS NULL THEN 0 ELSE CC.YSYWC END ) YSYWC,
           (CASE WHEN DD.WDWPPZL IS NULL THEN 0 ELSE DD.WDWPPZL END ) WDWPPZL,
           (CASE WHEN EE.WDWPPYWC IS NULL THEN 0 ELSE EE.WDWPPYWC END ) WDWPPYWC,
           (CASE WHEN FF.SDWPPZL IS NULL THEN 0 ELSE FF.SDWPPZL END ) SDWPPZL,
           (CASE WHEN GG.SDWPPYWC IS NULL THEN 0 ELSE GG.SDWPPYWC END ) SDWPPYWC,
           (CASE WHEN HH.YESDWPPZL IS NULL THEN 0 ELSE HH.YESDWPPZL END ) YESDWPPZL,
           (CASE WHEN II.YESDWPPYWC IS NULL THEN 0 ELSE II.YESDWPPYWC END ) YESDWPPYWC
      FROM AA FULL JOIN BB ON AA.ZGSWJ_DM = BB.ZGSWJ_DM
              FULL JOIN CC ON AA.ZGSWJ_DM = CC.ZGSWJ_DM
              FULL JOIN DD ON AA.ZGSWJ_DM = DD.ZGSWJ_DM
              FULL JOIN EE ON AA.ZGSWJ_DM = EE.ZGSWJ_DM
              FULL JOIN FF ON AA.ZGSWJ_DM = FF.ZGSWJ_DM
              FULL JOIN GG ON AA.ZGSWJ_DM = GG.ZGSWJ_DM
              FULL JOIN HH ON AA.ZGSWJ_DM = HH.ZGSWJ_DM
              FULL JOIN II ON AA.ZGSWJ_DM = II.ZGSWJ_DM) JJ
        WHERE JJ.ZGSWJ_DM IN (SELECT JG.SWJG_DM FROM DM_GY_SWJG JG WHERE JG.YXBZ = 'Y' AND JG.XYBZ = 'Y' START WITH JG.SWJG_DM = '13301000000' CONNECT BY PRIOR JG.SWJG_DM = JG.SJSWJG_DM)
     GROUP BY JJ.ZGSWJ_DM
     ORDER BY JJ.ZGSWJ_DM ASC;    
     
 
-- <!-- SHEET1◊‹º∆  – -->
WITH AA AS (SELECT A.ZGSWJ_DM, COUNT(1) YPPQC FROM DL_QRB A WHERE A.ZGSWJ_DM IS NOT NULL GROUP BY A.ZGSWJ_DM) ,
     BB AS (SELECT B.ZGSWJ_DM, COUNT(1) YSZL FROM DL_DQRB B WHERE B.ZGSWJ_DM IS NOT NULL AND B.SJLY LIKE '%¥Ê“…%' GROUP BY B.ZGSWJ_DM),
     CC AS (SELECT C.ZGSWJ_DM, COUNT(1) YSYWC FROM DL_DQRB C WHERE C.ZGSWJ_DM IS NOT NULL AND C.SJLY LIKE '%¥Ê“…%' AND C.YXBZ = 'N' GROUP BY C.ZGSWJ_DM),
     DD AS (SELECT D.ZGSWJ_DM, COUNT(1) WDWPPZL FROM DL_DQRB D WHERE D.ZGSWJ_DM IS NOT NULL AND D.SJLY LIKE '%Œ¥∆•≈‰%' AND D.YJYDGM = '5' GROUP BY D.ZGSWJ_DM),
     EE AS (SELECT E.ZGSWJ_DM, COUNT(1) WDWPPYWC FROM DL_DQRB E WHERE E.ZGSWJ_DM IS NOT NULL AND E.SJLY LIKE '%Œ¥∆•≈‰%' AND E.YXBZ = 'N' AND E.YJYDGM = '5' GROUP BY E.ZGSWJ_DM),
     FF AS (SELECT F.ZGSWJ_DM, COUNT(1) SDWPPZL FROM DL_DQRB F WHERE F.ZGSWJ_DM IS NOT NULL AND F.SJLY LIKE '%Œ¥∆•≈‰%' AND F.YJYDGM = '4' GROUP BY F.ZGSWJ_DM),
     GG AS (SELECT G.ZGSWJ_DM, COUNT(1) SDWPPYWC FROM DL_DQRB G WHERE G.ZGSWJ_DM IS NOT NULL AND G.SJLY LIKE '%Œ¥∆•≈‰%' AND G.YXBZ = 'N' AND G.YJYDGM = '4' GROUP BY G.ZGSWJ_DM),
     HH AS (SELECT H.ZGSWJ_DM, COUNT(1) YESDWPPZL FROM DL_DQRB H WHERE H.ZGSWJ_DM IS NOT NULL AND H.SJLY LIKE '%Œ¥∆•≈‰%' AND H.YJYDGM IN ('1','2','3') GROUP BY H.ZGSWJ_DM),
     II AS (SELECT I.ZGSWJ_DM, COUNT(1) YESDWPPYWC FROM DL_DQRB I WHERE I.ZGSWJ_DM IS NOT NULL AND I.SJLY LIKE '%Œ¥∆•≈‰%' AND I.YXBZ = 'N' AND I.YJYDGM IN ('1','2','3') GROUP BY I.ZGSWJ_DM)

SELECT SUM(KK.YPPQC) AS YPPQC,
       SUM(KK.YSZL) AS YSZL,
       SUM(KK.YSYWC) AS YSYWC,
       SUM(KK.YSSY) AS YSSY,
       (CASE WHEN SUM(KK.YSZL) = 0 THEN '0%' ELSE (TRUNC(SUM(KK.YSYWC) / SUM(KK.YSZL) * 100 , 2)) || '%' END) AS YSWCL,
       SUM(KK.WDWPPZL) AS WDWPPZL,
       SUM(KK.WDWPPYWC) AS WDWPPYWC,
       SUM(KK.WDWPPSY) AS WDWPPSY,
       (CASE WHEN SUM(KK.WDWPPZL) = 0 THEN '0%' ELSE (TRUNC(SUM(KK.WDWPPYWC) / SUM(KK.WDWPPZL) * 100 , 2)) || '%' END) AS WDWCL,
       SUM(KK.SDWPPZL) AS SDWPPZL,
       SUM(KK.SDWPPYWC) AS SDWPPYWC,
       SUM(KK.SDWPPSY) AS SDWPPSY,
       (CASE WHEN SUM(KK.SDWPPZL) = 0 THEN '0%' ELSE (TRUNC(SUM(KK.SDWPPYWC) / SUM(KK.SDWPPZL) * 100 , 2)) || '%' END) AS SDWCL,
       SUM(KK.YESDWPPZL) AS YESDWPPZL,
       SUM(KK.YESDWPPYWC) AS YESDWPPYWC,
       SUM(KK.YESDWPPSY) AS YESDWPPSY,
       (CASE WHEN SUM(KK.YESDWPPZL) = 0 THEN '0%' ELSE (TRUNC(SUM(KK.YESDWPPYWC) / SUM(KK.YESDWPPZL) * 100 , 2)) || '%' END) AS YESDWCL,
       (CASE WHEN (SUM(KK.YSZL)+SUM(KK.WDWPPZL)+SUM(KK.SDWPPZL)+SUM(KK.YESDWPPZL)) = 0 THEN '0%' ELSE (TRUNC((SUM(KK.YSYWC)+SUM(KK.WDWPPYWC)+SUM(KK.SDWPPYWC)+SUM(KK.YESDWPPYWC)) / (SUM(KK.YSZL)+SUM(KK.WDWPPZL)+SUM(KK.SDWPPZL)+SUM(KK.YESDWPPZL)) * 100 , 2)) || '%' END) WCL
 FROM£®
 SELECT '1' XH,
        (SELECT K.SWJG_DM FROM HX_DM_ZDY.DM_GY_SWJG K WHERE K.SWJG_DM IN (SELECT M.SJSWJG_DM FROM HX_DM_ZDY.DM_GY_SWJG M WHERE M.SWJG_DM = JJ.ZGSWJ_DM)) AS ZGSWJGDM,
        (SELECT P.SWJGMC FROM HX_DM_ZDY.DM_GY_SWJG P WHERE P.SWJG_DM IN (SELECT T.SJSWJG_DM FROM HX_DM_ZDY.DM_GY_SWJG T WHERE T.SWJG_DM = JJ.ZGSWJ_DM)) AS ZGSWJGMC,
        (SELECT SWJG.SWJGMC FROM HX_DM_ZDY.DM_GY_SWJG SWJG WHERE SWJG.SWJG_DM = JJ.ZGSWJ_DM) AS XXSWJGMC,
        SUM(JJ.YPPQC) AS YPPQC,
        SUM(JJ.YSZL) AS YSZL,
        SUM(JJ.YSYWC) AS YSYWC,
        (SUM(JJ.YSZL) - SUM(JJ.YSYWC)) AS YSSY,
        (CASE WHEN SUM(JJ.YSZL) = 0 THEN '0%' ELSE (TRUNC(SUM(JJ.YSYWC) / SUM(JJ.YSZL) * 100 , 2)) || '%' END) AS YSWCL,
        SUM(JJ.WDWPPZL) AS WDWPPZL,
        SUM(JJ.WDWPPYWC) AS WDWPPYWC,
        (SUM(JJ.WDWPPZL) - SUM(JJ.WDWPPYWC)) AS WDWPPSY,
        (CASE WHEN SUM(JJ.WDWPPZL) = 0 THEN '0%' ELSE (TRUNC(SUM(JJ.WDWPPYWC) / SUM(JJ.WDWPPZL) * 100 , 2)) || '%' END) AS WDWCL,
        SUM(JJ.SDWPPZL) AS SDWPPZL,
        SUM(JJ.SDWPPYWC) AS SDWPPYWC,
        (SUM(JJ.SDWPPZL) - SUM(JJ.SDWPPYWC)) AS SDWPPSY,
        (CASE WHEN SUM(JJ.SDWPPZL) = 0 THEN '0%' ELSE (TRUNC(SUM(JJ.SDWPPYWC) / SUM(JJ.SDWPPZL) * 100 , 2)) || '%' END) AS SDWCL,
        SUM(JJ.YESDWPPZL) AS YESDWPPZL,
        SUM(JJ.YESDWPPYWC) AS YESDWPPYWC,
        (SUM(JJ.YESDWPPZL) - SUM(JJ.YESDWPPYWC)) AS YESDWPPSY,
        (CASE WHEN SUM(JJ.YESDWPPZL) = 0 THEN '0%' ELSE (TRUNC(SUM(JJ.YESDWPPYWC) / SUM(JJ.YESDWPPZL) * 100 , 2)) || '%' END) AS YESDWCL,
        (CASE WHEN (SUM(JJ.YSZL)+SUM(JJ.WDWPPZL)+SUM(JJ.SDWPPZL)+SUM(JJ.YESDWPPZL)) = 0 THEN '0%' ELSE (TRUNC((SUM(JJ.YSYWC)+SUM(JJ.WDWPPYWC)+SUM(JJ.SDWPPYWC)+SUM(JJ.YESDWPPYWC)) / (SUM(JJ.YSZL)+SUM(JJ.WDWPPZL)+SUM(JJ.SDWPPZL)+SUM(JJ.YESDWPPZL)) * 100 , 2)) || '%' END) WCL
  FROM (
    SELECT COALESCE(AA.ZGSWJ_DM, BB.ZGSWJ_DM, CC.ZGSWJ_DM, DD.ZGSWJ_DM, EE.ZGSWJ_DM , FF.ZGSWJ_DM , GG.ZGSWJ_DM, HH.ZGSWJ_DM, II.ZGSWJ_DM) ZGSWJ_DM,
           (CASE WHEN AA.YPPQC IS NULL THEN 0 ELSE AA.YPPQC END ) YPPQC,
           (CASE WHEN BB.YSZL IS NULL THEN 0 ELSE BB.YSZL END ) YSZL,
           (CASE WHEN CC.YSYWC IS NULL THEN 0 ELSE CC.YSYWC END ) YSYWC,
           (CASE WHEN DD.WDWPPZL IS NULL THEN 0 ELSE DD.WDWPPZL END ) WDWPPZL,
           (CASE WHEN EE.WDWPPYWC IS NULL THEN 0 ELSE EE.WDWPPYWC END ) WDWPPYWC,
           (CASE WHEN FF.SDWPPZL IS NULL THEN 0 ELSE FF.SDWPPZL END ) SDWPPZL,
           (CASE WHEN GG.SDWPPYWC IS NULL THEN 0 ELSE GG.SDWPPYWC END ) SDWPPYWC,
           (CASE WHEN HH.YESDWPPZL IS NULL THEN 0 ELSE HH.YESDWPPZL END ) YESDWPPZL,
           (CASE WHEN II.YESDWPPYWC IS NULL THEN 0 ELSE II.YESDWPPYWC END ) YESDWPPYWC
      FROM AA FULL JOIN BB ON AA.ZGSWJ_DM = BB.ZGSWJ_DM
              FULL JOIN CC ON AA.ZGSWJ_DM = CC.ZGSWJ_DM
              FULL JOIN DD ON AA.ZGSWJ_DM = DD.ZGSWJ_DM
              FULL JOIN EE ON AA.ZGSWJ_DM = EE.ZGSWJ_DM
              FULL JOIN FF ON AA.ZGSWJ_DM = FF.ZGSWJ_DM
              FULL JOIN GG ON AA.ZGSWJ_DM = GG.ZGSWJ_DM
              FULL JOIN HH ON AA.ZGSWJ_DM = HH.ZGSWJ_DM
              FULL JOIN II ON AA.ZGSWJ_DM = II.ZGSWJ_DM) JJ 
        WHERE JJ.ZGSWJ_DM IN (SELECT JG.SWJG_DM FROM DM_GY_SWJG JG WHERE JG.YXBZ = 'Y' AND JG.XYBZ = 'Y' START WITH JG.SWJG_DM = '13301000000' CONNECT BY PRIOR JG.SWJG_DM = JG.SJSWJG_DM)
     GROUP BY JJ.ZGSWJ_DM) KK GROUP BY KK.XH;   
  
  
------------------------------------------------------------------------------------------------------------------------------------------------------------------------
      
-- <!-- SHEET1Õ≥º∆ œÿ -->
WITH AA AS (SELECT A.ZGSWSKFJ_DM, COUNT(1) YPPQC FROM DL_QRB A WHERE A.ZGSWJ_DM IS NOT NULL AND A.ZGSWJ_DM IN (SELECT JG.SWJG_DM FROM DM_GY_SWJG JG WHERE JG.YXBZ = 'Y' AND JG.XYBZ = 'Y' START WITH JG.SWJG_DM = '13301270000' CONNECT BY PRIOR JG.SWJG_DM = JG.SJSWJG_DM) GROUP BY A.ZGSWSKFJ_DM) ,
     BB AS (SELECT B.ZGSWSKFJ_DM, COUNT(1) YSZL FROM DL_DQRB B WHERE B.ZGSWJ_DM IS NOT NULL AND B.SJLY LIKE '%¥Ê“…%'AND B.ZGSWJ_DM IN (SELECT JG.SWJG_DM FROM DM_GY_SWJG JG WHERE JG.YXBZ = 'Y' AND JG.XYBZ = 'Y' START WITH JG.SWJG_DM = '13301270000' CONNECT BY PRIOR JG.SWJG_DM = JG.SJSWJG_DM) GROUP BY B.ZGSWSKFJ_DM),
     CC AS (SELECT C.ZGSWSKFJ_DM, COUNT(1) YSYWC FROM DL_DQRB C WHERE C.ZGSWJ_DM IS NOT NULL AND C.SJLY LIKE '%¥Ê“…%' AND C.YXBZ = 'N' AND C.ZGSWJ_DM IN (SELECT JG.SWJG_DM FROM DM_GY_SWJG JG WHERE JG.YXBZ = 'Y' AND JG.XYBZ = 'Y' START WITH JG.SWJG_DM = '13301270000' CONNECT BY PRIOR JG.SWJG_DM = JG.SJSWJG_DM) GROUP BY C.ZGSWSKFJ_DM),
     DD AS (SELECT D.ZGSWSKFJ_DM, COUNT(1) WDWPPZL FROM DL_DQRB D WHERE D.ZGSWJ_DM IS NOT NULL AND D.SJLY LIKE '%Œ¥∆•≈‰%' AND D.YJYDGM = '5' AND D.ZGSWJ_DM IN (SELECT JG.SWJG_DM FROM DM_GY_SWJG JG WHERE JG.YXBZ = 'Y' AND JG.XYBZ = 'Y' START WITH JG.SWJG_DM = '13301270000' CONNECT BY PRIOR JG.SWJG_DM = JG.SJSWJG_DM) GROUP BY D.ZGSWSKFJ_DM),
     EE AS (SELECT E.ZGSWSKFJ_DM, COUNT(1) WDWPPYWC FROM DL_DQRB E WHERE E.ZGSWJ_DM IS NOT NULL AND E.SJLY LIKE '%Œ¥∆•≈‰%' AND E.YXBZ = 'N' AND E.YJYDGM = '5' AND E.ZGSWJ_DM IN (SELECT JG.SWJG_DM FROM DM_GY_SWJG JG WHERE JG.YXBZ = 'Y' AND JG.XYBZ = 'Y' START WITH JG.SWJG_DM = '13301270000' CONNECT BY PRIOR JG.SWJG_DM = JG.SJSWJG_DM) GROUP BY E.ZGSWSKFJ_DM),
     FF AS (SELECT F.ZGSWSKFJ_DM, COUNT(1) SDWPPZL FROM DL_DQRB F WHERE F.ZGSWJ_DM IS NOT NULL AND F.SJLY LIKE '%Œ¥∆•≈‰%' AND F.YJYDGM = '4' AND F.ZGSWJ_DM IN (SELECT JG.SWJG_DM FROM DM_GY_SWJG JG WHERE JG.YXBZ = 'Y' AND JG.XYBZ = 'Y' START WITH JG.SWJG_DM = '13301270000' CONNECT BY PRIOR JG.SWJG_DM = JG.SJSWJG_DM) GROUP BY F.ZGSWSKFJ_DM),
     GG AS (SELECT G.ZGSWSKFJ_DM, COUNT(1) SDWPPYWC FROM DL_DQRB G WHERE G.ZGSWJ_DM IS NOT NULL AND G.SJLY LIKE '%Œ¥∆•≈‰%' AND G.YXBZ = 'N' AND G.YJYDGM = '4' AND G.ZGSWJ_DM IN (SELECT JG.SWJG_DM FROM DM_GY_SWJG JG WHERE JG.YXBZ = 'Y' AND JG.XYBZ = 'Y' START WITH JG.SWJG_DM = '13301270000' CONNECT BY PRIOR JG.SWJG_DM = JG.SJSWJG_DM) GROUP BY G.ZGSWSKFJ_DM),
     HH AS (SELECT H.ZGSWSKFJ_DM, COUNT(1) YESDWPPZL FROM DL_DQRB H WHERE H.ZGSWJ_DM IS NOT NULL AND H.SJLY LIKE '%Œ¥∆•≈‰%' AND H.YJYDGM IN ('1', '2', '3') AND H.ZGSWJ_DM IN (SELECT JG.SWJG_DM FROM DM_GY_SWJG JG WHERE JG.YXBZ = 'Y' AND JG.XYBZ = 'Y' START WITH JG.SWJG_DM = '13301270000' CONNECT BY PRIOR JG.SWJG_DM = JG.SJSWJG_DM) GROUP BY H.ZGSWSKFJ_DM),
     II AS (SELECT I.ZGSWSKFJ_DM, COUNT(1) YESDWPPYWC FROM DL_DQRB I WHERE I.ZGSWJ_DM IS NOT NULL AND I.SJLY LIKE '%Œ¥∆•≈‰%' AND I.YXBZ = 'N' AND I.YJYDGM IN ('1', '2', '3') AND I.ZGSWJ_DM IN (SELECT JG.SWJG_DM FROM DM_GY_SWJG JG WHERE JG.YXBZ = 'Y' AND JG.XYBZ = 'Y' START WITH JG.SWJG_DM = '13301270000' CONNECT BY PRIOR JG.SWJG_DM = JG.SJSWJG_DM) GROUP BY I.ZGSWSKFJ_DM)

 SELECT (SELECT K.SWJG_DM FROM HX_DM_ZDY.DM_GY_SWJG K WHERE K.SWJG_DM IN (SELECT M.SJSWJG_DM FROM HX_DM_ZDY.DM_GY_SWJG M WHERE M.SWJG_DM = JJ.ZGSWSKFJ_DM)) AS ZGSWJGDM,
        (CASE WHEN JJ.ZGSWSKFJ_DM <> 'Œ¥∑÷≈‰' THEN (SELECT JG.SWJGMC FROM HX_DM_ZDY.DM_GY_SWJG JG WHERE JG.SWJG_DM IN (SELECT T.SJSWJG_DM FROM HX_DM_ZDY.DM_GY_SWJG T WHERE T.SWJG_DM = JJ.ZGSWSKFJ_DM))
                                              ELSE JJ.ZGSWSKFJ_DM END) AS ZGSWJGMC,
        (SELECT SWJG.SWJGMC FROM HX_DM_ZDY.DM_GY_SWJG SWJG WHERE SWJG.SWJG_DM = JJ.ZGSWSKFJ_DM) AS XXSWJGMC,
        SUM(JJ.YPPQC) AS YPPQC,
        SUM(JJ.YSZL) AS YSZL,
        SUM(JJ.YSYWC) AS YSYWC,
        (SUM(JJ.YSZL) - SUM(JJ.YSYWC)) AS YSSY,
        (CASE WHEN SUM(JJ.YSZL) = 0 THEN '0%' ELSE (TRUNC(SUM(JJ.YSYWC) / SUM(JJ.YSZL) * 100 , 2)) || '%' END) AS YSWCL,
        SUM(JJ.WDWPPZL) AS WDWPPZL,
        SUM(JJ.WDWPPYWC) AS WDWPPYWC,
        (SUM(JJ.WDWPPZL) - SUM(JJ.WDWPPYWC)) AS WDWPPSY,
        (CASE WHEN SUM(JJ.WDWPPZL) = 0 THEN '0%' ELSE (TRUNC(SUM(JJ.WDWPPYWC) / SUM(JJ.WDWPPZL) * 100 , 2)) || '%' END) AS WDWCL,
        SUM(JJ.SDWPPZL) AS SDWPPZL,
        SUM(JJ.SDWPPYWC) AS SDWPPYWC,
        (SUM(JJ.SDWPPZL) - SUM(JJ.SDWPPYWC)) AS SDWPPSY,
        (CASE WHEN SUM(JJ.SDWPPZL) = 0 THEN '0%' ELSE (TRUNC(SUM(JJ.SDWPPYWC) / SUM(JJ.SDWPPZL) * 100 , 2)) || '%' END) AS SDWCL,
        SUM(JJ.YESDWPPZL) AS YESDWPPZL,
        SUM(JJ.YESDWPPYWC) AS YESDWPPYWC,
        (SUM(JJ.YESDWPPZL) - SUM(JJ.YESDWPPYWC)) AS YESDWPPSY,
        (CASE WHEN SUM(JJ.YESDWPPZL) = 0 THEN '0%' ELSE (TRUNC(SUM(JJ.YESDWPPYWC) / SUM(JJ.YESDWPPZL) * 100 , 2)) || '%' END) AS YESDWCL,
        (CASE WHEN (SUM(JJ.YSZL)+SUM(JJ.WDWPPZL)+SUM(JJ.SDWPPZL)+SUM(JJ.YESDWPPZL)) = 0 THEN '0%' ELSE (TRUNC((SUM(JJ.YSYWC)+SUM(JJ.WDWPPYWC)+SUM(JJ.SDWPPYWC)+SUM(JJ.YESDWPPYWC)) / (SUM(JJ.YSZL)+SUM(JJ.WDWPPZL)+SUM(JJ.SDWPPZL)+SUM(JJ.YESDWPPZL)) * 100 , 2)) || '%' END) WCL
  FROM (
    SELECT (CASE WHEN (COALESCE(AA.ZGSWSKFJ_DM, BB.ZGSWSKFJ_DM, CC.ZGSWSKFJ_DM, DD.ZGSWSKFJ_DM, EE.ZGSWSKFJ_DM , FF.ZGSWSKFJ_DM , GG.ZGSWSKFJ_DM, HH.ZGSWSKFJ_DM, II.ZGSWSKFJ_DM)) 
                             IN(SELECT JG.SWJG_DM FROM DM_GY_SWJG JG WHERE JG.YXBZ = 'Y' AND JG.XYBZ = 'Y' START WITH JG.SWJG_DM = '13301270000' CONNECT BY PRIOR JG.SWJG_DM = JG.SJSWJG_DM)
                             THEN (COALESCE(AA.ZGSWSKFJ_DM, BB.ZGSWSKFJ_DM, CC.ZGSWSKFJ_DM, DD.ZGSWSKFJ_DM, EE.ZGSWSKFJ_DM , FF.ZGSWSKFJ_DM , GG.ZGSWSKFJ_DM, HH.ZGSWSKFJ_DM, II.ZGSWSKFJ_DM)) 
                             ELSE 'Œ¥∑÷≈‰' END) ZGSWSKFJ_DM,
           (CASE WHEN AA.YPPQC IS NULL THEN 0 ELSE AA.YPPQC END ) YPPQC,
           (CASE WHEN BB.YSZL IS NULL THEN 0 ELSE BB.YSZL END ) YSZL,
           (CASE WHEN CC.YSYWC IS NULL THEN 0 ELSE CC.YSYWC END ) YSYWC,
           (CASE WHEN DD.WDWPPZL IS NULL THEN 0 ELSE DD.WDWPPZL END ) WDWPPZL,
           (CASE WHEN EE.WDWPPYWC IS NULL THEN 0 ELSE EE.WDWPPYWC END ) WDWPPYWC,
           (CASE WHEN FF.SDWPPZL IS NULL THEN 0 ELSE FF.SDWPPZL END ) SDWPPZL,
           (CASE WHEN GG.SDWPPYWC IS NULL THEN 0 ELSE GG.SDWPPYWC END ) SDWPPYWC,
           (CASE WHEN HH.YESDWPPZL IS NULL THEN 0 ELSE HH.YESDWPPZL END ) YESDWPPZL,
           (CASE WHEN II.YESDWPPYWC IS NULL THEN 0 ELSE II.YESDWPPYWC END ) YESDWPPYWC
      FROM AA FULL JOIN BB ON AA.ZGSWSKFJ_DM = BB.ZGSWSKFJ_DM
              FULL JOIN CC ON AA.ZGSWSKFJ_DM = CC.ZGSWSKFJ_DM
              FULL JOIN DD ON AA.ZGSWSKFJ_DM = DD.ZGSWSKFJ_DM
              FULL JOIN EE ON AA.ZGSWSKFJ_DM = EE.ZGSWSKFJ_DM
              FULL JOIN FF ON AA.ZGSWSKFJ_DM = FF.ZGSWSKFJ_DM
              FULL JOIN GG ON AA.ZGSWSKFJ_DM = GG.ZGSWSKFJ_DM
              FULL JOIN HH ON AA.ZGSWSKFJ_DM = HH.ZGSWSKFJ_DM
              FULL JOIN II ON AA.ZGSWSKFJ_DM = II.ZGSWSKFJ_DM) JJ 
     GROUP BY JJ.ZGSWSKFJ_DM
     ORDER BY JJ.ZGSWSKFJ_DM ASC;  
 
 
 

 
 
 
 
 
-- <!-- SHEET1◊‹º∆ œÿ -->
    
WITH AA AS (SELECT A.ZGSWSKFJ_DM, COUNT(1) YPPQC FROM DL_QRB A WHERE A.ZGSWJ_DM IS NOT NULL AND A.ZGSWJ_DM IN (SELECT JG.SWJG_DM FROM DM_GY_SWJG JG WHERE JG.YXBZ = 'Y' AND JG.XYBZ = 'Y' START WITH JG.SWJG_DM = '13301270000' CONNECT BY PRIOR JG.SWJG_DM = JG.SJSWJG_DM) GROUP BY A.ZGSWSKFJ_DM) ,
     BB AS (SELECT B.ZGSWSKFJ_DM, COUNT(1) YSZL FROM DL_DQRB B WHERE B.ZGSWJ_DM IS NOT NULL AND B.SJLY LIKE '%¥Ê“…%'AND B.ZGSWJ_DM IN (SELECT JG.SWJG_DM FROM DM_GY_SWJG JG WHERE JG.YXBZ = 'Y' AND JG.XYBZ = 'Y' START WITH JG.SWJG_DM = '13301270000' CONNECT BY PRIOR JG.SWJG_DM = JG.SJSWJG_DM) GROUP BY B.ZGSWSKFJ_DM),
     CC AS (SELECT C.ZGSWSKFJ_DM, COUNT(1) YSYWC FROM DL_DQRB C WHERE C.ZGSWJ_DM IS NOT NULL AND C.SJLY LIKE '%¥Ê“…%' AND C.YXBZ = 'N' AND C.ZGSWJ_DM IN (SELECT JG.SWJG_DM FROM DM_GY_SWJG JG WHERE JG.YXBZ = 'Y' AND JG.XYBZ = 'Y' START WITH JG.SWJG_DM = '13301270000' CONNECT BY PRIOR JG.SWJG_DM = JG.SJSWJG_DM) GROUP BY C.ZGSWSKFJ_DM),
     DD AS (SELECT D.ZGSWSKFJ_DM, COUNT(1) WDWPPZL FROM DL_DQRB D WHERE D.ZGSWJ_DM IS NOT NULL AND D.SJLY LIKE '%Œ¥∆•≈‰%' AND D.YJYDGM = '5' AND D.ZGSWJ_DM IN (SELECT JG.SWJG_DM FROM DM_GY_SWJG JG WHERE JG.YXBZ = 'Y' AND JG.XYBZ = 'Y' START WITH JG.SWJG_DM = '13301270000' CONNECT BY PRIOR JG.SWJG_DM = JG.SJSWJG_DM) GROUP BY D.ZGSWSKFJ_DM),
     EE AS (SELECT E.ZGSWSKFJ_DM, COUNT(1) WDWPPYWC FROM DL_DQRB E WHERE E.ZGSWJ_DM IS NOT NULL AND E.SJLY LIKE '%Œ¥∆•≈‰%' AND E.YXBZ = 'N' AND E.YJYDGM = '5' AND E.ZGSWJ_DM IN (SELECT JG.SWJG_DM FROM DM_GY_SWJG JG WHERE JG.YXBZ = 'Y' AND JG.XYBZ = 'Y' START WITH JG.SWJG_DM = '13301270000' CONNECT BY PRIOR JG.SWJG_DM = JG.SJSWJG_DM) GROUP BY E.ZGSWSKFJ_DM),
     FF AS (SELECT F.ZGSWSKFJ_DM, COUNT(1) SDWPPZL FROM DL_DQRB F WHERE F.ZGSWJ_DM IS NOT NULL AND F.SJLY LIKE '%Œ¥∆•≈‰%' AND F.YJYDGM = '4' AND F.ZGSWJ_DM IN (SELECT JG.SWJG_DM FROM DM_GY_SWJG JG WHERE JG.YXBZ = 'Y' AND JG.XYBZ = 'Y' START WITH JG.SWJG_DM = '13301270000' CONNECT BY PRIOR JG.SWJG_DM = JG.SJSWJG_DM) GROUP BY F.ZGSWSKFJ_DM),
     GG AS (SELECT G.ZGSWSKFJ_DM, COUNT(1) SDWPPYWC FROM DL_DQRB G WHERE G.ZGSWJ_DM IS NOT NULL AND G.SJLY LIKE '%Œ¥∆•≈‰%' AND G.YXBZ = 'N' AND G.YJYDGM = '4' AND G.ZGSWJ_DM IN (SELECT JG.SWJG_DM FROM DM_GY_SWJG JG WHERE JG.YXBZ = 'Y' AND JG.XYBZ = 'Y' START WITH JG.SWJG_DM = '13301270000' CONNECT BY PRIOR JG.SWJG_DM = JG.SJSWJG_DM) GROUP BY G.ZGSWSKFJ_DM),
     HH AS (SELECT H.ZGSWSKFJ_DM, COUNT(1) YESDWPPZL FROM DL_DQRB H WHERE H.ZGSWJ_DM IS NOT NULL AND H.SJLY LIKE '%Œ¥∆•≈‰%' AND H.YJYDGM IN ('1', '2', '3') AND H.ZGSWJ_DM IN (SELECT JG.SWJG_DM FROM DM_GY_SWJG JG WHERE JG.YXBZ = 'Y' AND JG.XYBZ = 'Y' START WITH JG.SWJG_DM = '13301270000' CONNECT BY PRIOR JG.SWJG_DM = JG.SJSWJG_DM) GROUP BY H.ZGSWSKFJ_DM),
     II AS (SELECT I.ZGSWSKFJ_DM, COUNT(1) YESDWPPYWC FROM DL_DQRB I WHERE I.ZGSWJ_DM IS NOT NULL AND I.SJLY LIKE '%Œ¥∆•≈‰%' AND I.YXBZ = 'N' AND I.YJYDGM IN ('1', '2', '3') AND I.ZGSWJ_DM IN (SELECT JG.SWJG_DM FROM DM_GY_SWJG JG WHERE JG.YXBZ = 'Y' AND JG.XYBZ = 'Y' START WITH JG.SWJG_DM = '13301270000' CONNECT BY PRIOR JG.SWJG_DM = JG.SJSWJG_DM) GROUP BY I.ZGSWSKFJ_DM)


SELECT SUM(KK.YPPQC) AS YPPQC,
       SUM(KK.YSZL) AS YSZL,
       SUM(KK.YSYWC) AS YSYWC,
       SUM(KK.YSSY) AS YSSY,
       (CASE WHEN SUM(KK.YSZL) = 0 THEN '0%' ELSE (TRUNC(SUM(KK.YSYWC) / SUM(KK.YSZL) * 100 , 2)) || '%' END) AS YSWCL,
       SUM(KK.WDWPPZL) AS WDWPPZL,
       SUM(KK.WDWPPYWC) AS WDWPPYWC,
       SUM(KK.WDWPPSY) AS WDWPPSY,
       (CASE WHEN SUM(KK.WDWPPZL) = 0 THEN '0%' ELSE (TRUNC(SUM(KK.WDWPPYWC) / SUM(KK.WDWPPZL) * 100 , 2)) || '%' END) AS WDWCL,
       SUM(KK.SDWPPZL) AS SDWPPZL,
       SUM(KK.SDWPPYWC) AS SDWPPYWC,
       SUM(KK.SDWPPSY) AS SDWPPSY,
       (CASE WHEN SUM(KK.SDWPPZL) = 0 THEN '0%' ELSE (TRUNC(SUM(KK.SDWPPYWC) / SUM(KK.SDWPPZL) * 100 , 2)) || '%' END) AS SDWCL,
       SUM(KK.YESDWPPZL) AS YESDWPPZL,
       SUM(KK.YESDWPPYWC) AS YESDWPPYWC,
       SUM(KK.YESDWPPSY) AS YESDWPPSY,
       (CASE WHEN SUM(KK.YESDWPPZL) = 0 THEN '0%' ELSE (TRUNC(SUM(KK.YESDWPPYWC) / SUM(KK.YESDWPPZL) * 100 , 2)) || '%' END) AS YESDWCL,
       (CASE WHEN (SUM(KK.YSZL)+SUM(KK.WDWPPZL)+SUM(KK.SDWPPZL)+SUM(KK.YESDWPPZL)) = 0 THEN '0%' ELSE (TRUNC((SUM(KK.YSYWC)+SUM(KK.WDWPPYWC)+SUM(KK.SDWPPYWC)+SUM(KK.YESDWPPYWC)) / (SUM(KK.YSZL)+SUM(KK.WDWPPZL)+SUM(KK.SDWPPZL)+SUM(KK.YESDWPPZL)) * 100 , 2)) || '%' END) WCL
 FROM£®
 SELECT '1' XH,
        (SELECT K.SWJG_DM FROM HX_DM_ZDY.DM_GY_SWJG K WHERE K.SWJG_DM IN (SELECT M.SJSWJG_DM FROM HX_DM_ZDY.DM_GY_SWJG M WHERE M.SWJG_DM = JJ.ZGSWSKFJ_DM)) AS ZGSWJGDM,
        (CASE WHEN JJ.ZGSWSKFJ_DM <> 'Œ¥∑÷≈‰' THEN (SELECT JG.SWJGMC FROM HX_DM_ZDY.DM_GY_SWJG JG WHERE JG.SWJG_DM IN (SELECT T.SJSWJG_DM FROM HX_DM_ZDY.DM_GY_SWJG T WHERE T.SWJG_DM = JJ.ZGSWSKFJ_DM))
                                              ELSE JJ.ZGSWSKFJ_DM END) AS ZGSWJGMC,
        (SELECT SWJG.SWJGMC FROM HX_DM_ZDY.DM_GY_SWJG SWJG WHERE SWJG.SWJG_DM = JJ.ZGSWSKFJ_DM) AS XXSWJGMC,
        SUM(JJ.YPPQC) AS YPPQC,
        SUM(JJ.YSZL) AS YSZL,
        SUM(JJ.YSYWC) AS YSYWC,
        (SUM(JJ.YSZL) - SUM(JJ.YSYWC)) AS YSSY,
        (CASE WHEN SUM(JJ.YSZL) = 0 THEN '0%' ELSE (TRUNC(SUM(JJ.YSYWC) / SUM(JJ.YSZL) * 100 , 2)) || '%' END) AS YSWCL,
        SUM(JJ.WDWPPZL) AS WDWPPZL,
        SUM(JJ.WDWPPYWC) AS WDWPPYWC,
        (SUM(JJ.WDWPPZL) - SUM(JJ.WDWPPYWC)) AS WDWPPSY,
        (CASE WHEN SUM(JJ.WDWPPZL) = 0 THEN '0%' ELSE (TRUNC(SUM(JJ.WDWPPYWC) / SUM(JJ.WDWPPZL) * 100 , 2)) || '%' END) AS WDWCL,
        SUM(JJ.SDWPPZL) AS SDWPPZL,
        SUM(JJ.SDWPPYWC) AS SDWPPYWC,
        (SUM(JJ.SDWPPZL) - SUM(JJ.SDWPPYWC)) AS SDWPPSY,
        (CASE WHEN SUM(JJ.SDWPPZL) = 0 THEN '0%' ELSE (TRUNC(SUM(JJ.SDWPPYWC) / SUM(JJ.SDWPPZL) * 100 , 2)) || '%' END) AS SDWCL,
        SUM(JJ.YESDWPPZL) AS YESDWPPZL,
        SUM(JJ.YESDWPPYWC) AS YESDWPPYWC,
        (SUM(JJ.YESDWPPZL) - SUM(JJ.YESDWPPYWC)) AS YESDWPPSY,
        (CASE WHEN SUM(JJ.YESDWPPZL) = 0 THEN '0%' ELSE (TRUNC(SUM(JJ.YESDWPPYWC) / SUM(JJ.YESDWPPZL) * 100 , 2)) || '%' END) AS YESDWCL,
        (CASE WHEN (SUM(JJ.YSZL)+SUM(JJ.WDWPPZL)+SUM(JJ.SDWPPZL)+SUM(JJ.YESDWPPZL)) = 0 THEN '0%' ELSE (TRUNC((SUM(JJ.YSYWC)+SUM(JJ.WDWPPYWC)+SUM(JJ.SDWPPYWC)+SUM(JJ.YESDWPPYWC)) / (SUM(JJ.YSZL)+SUM(JJ.WDWPPZL)+SUM(JJ.SDWPPZL)+SUM(JJ.YESDWPPZL)) * 100 , 2)) || '%' END) WCL
  FROM (
    SELECT (CASE WHEN (COALESCE(AA.ZGSWSKFJ_DM, BB.ZGSWSKFJ_DM, CC.ZGSWSKFJ_DM, DD.ZGSWSKFJ_DM, EE.ZGSWSKFJ_DM , FF.ZGSWSKFJ_DM , GG.ZGSWSKFJ_DM, HH.ZGSWSKFJ_DM, II.ZGSWSKFJ_DM)) 
                             IN(SELECT JG.SWJG_DM FROM DM_GY_SWJG JG WHERE JG.YXBZ = 'Y' AND JG.XYBZ = 'Y' START WITH JG.SWJG_DM = '13301270000' CONNECT BY PRIOR JG.SWJG_DM = JG.SJSWJG_DM)
                             THEN (COALESCE(AA.ZGSWSKFJ_DM, BB.ZGSWSKFJ_DM, CC.ZGSWSKFJ_DM, DD.ZGSWSKFJ_DM, EE.ZGSWSKFJ_DM , FF.ZGSWSKFJ_DM , GG.ZGSWSKFJ_DM, HH.ZGSWSKFJ_DM, II.ZGSWSKFJ_DM)) 
                             ELSE 'Œ¥∑÷≈‰' END) ZGSWSKFJ_DM,
           (CASE WHEN AA.YPPQC IS NULL THEN 0 ELSE AA.YPPQC END ) YPPQC,
           (CASE WHEN BB.YSZL IS NULL THEN 0 ELSE BB.YSZL END ) YSZL,
           (CASE WHEN CC.YSYWC IS NULL THEN 0 ELSE CC.YSYWC END ) YSYWC,
           (CASE WHEN DD.WDWPPZL IS NULL THEN 0 ELSE DD.WDWPPZL END ) WDWPPZL,
           (CASE WHEN EE.WDWPPYWC IS NULL THEN 0 ELSE EE.WDWPPYWC END ) WDWPPYWC,
           (CASE WHEN FF.SDWPPZL IS NULL THEN 0 ELSE FF.SDWPPZL END ) SDWPPZL,
           (CASE WHEN GG.SDWPPYWC IS NULL THEN 0 ELSE GG.SDWPPYWC END ) SDWPPYWC,
           (CASE WHEN HH.YESDWPPZL IS NULL THEN 0 ELSE HH.YESDWPPZL END ) YESDWPPZL,
           (CASE WHEN II.YESDWPPYWC IS NULL THEN 0 ELSE II.YESDWPPYWC END ) YESDWPPYWC
      FROM AA FULL JOIN BB ON AA.ZGSWSKFJ_DM = BB.ZGSWSKFJ_DM
              FULL JOIN CC ON AA.ZGSWSKFJ_DM = CC.ZGSWSKFJ_DM
              FULL JOIN DD ON AA.ZGSWSKFJ_DM = DD.ZGSWSKFJ_DM
              FULL JOIN EE ON AA.ZGSWSKFJ_DM = EE.ZGSWSKFJ_DM
              FULL JOIN FF ON AA.ZGSWSKFJ_DM = FF.ZGSWSKFJ_DM
              FULL JOIN GG ON AA.ZGSWSKFJ_DM = GG.ZGSWSKFJ_DM
              FULL JOIN HH ON AA.ZGSWSKFJ_DM = HH.ZGSWSKFJ_DM
              FULL JOIN II ON AA.ZGSWSKFJ_DM = II.ZGSWSKFJ_DM) JJ 
     GROUP BY JJ.ZGSWSKFJ_DM) KK GROUP BY KK.XH;  